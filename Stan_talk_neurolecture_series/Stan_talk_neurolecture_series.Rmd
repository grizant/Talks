---
title: "Reasoning with Uncertainty the Bayesian way"
subtitle: "with examples in Cognitive Modeling in R and Stan"
author: "AG Schissler"
date: "2/09/2018"
output: beamer_presentation
toc: true
bibliography: library.bib
header-includes:
- \usepackage{graphicx}
- \usepackage{pdfpages}
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
suppressWarnings(library(rstan))
```

# Motivation

## The problem
- Reproducibility crisis (what to cite?)
- confusion
- Impact of Statistical methods for research workers @Fisher1925

## ASA on p-values from @Wasserstein2016
1. P-values can indicate how incompatible the data are with a specified statistical model.
2. P-values do not measure the probability that the studied hypothesis is true, or the probability that the data were produced by random chance alone.
3. Scientific conclusions and business or policy decisions should not be based only on whether a p-value passes a specific threshold.
4. Proper inference requires full reporting and transparency
5. A p-value, or statistical significance, does not measure the size of an effect or the importance of a result.
6. By itself, a p-value does not provide a good measure of evidence regarding a model or hypothesis.

## Statistical Rethinking @McElreath2016

\includegraphics[page=4,width=0.8\paperwidth]{Lecture01.pdf}

## flowchart

\includegraphics[height=0.9\paperheight, keepaspectratio]{stats_flow_chart_v2014.pdf}

## Lindley 1986 quote?

# Bayes 101

## General principles

## Prediction

## Sequential updating

## MCMC

# Case Study I: Inferring IQ using Gaussians

## I.1. Research question and data 

We seek to estimate the IQ of a set of people. There are only three subjects and each take three IQ tests. The data are displayed below:

```{r IQ_data}
x <- matrix(c(90, 95, 100, 105, 110, 115, 150, 155, 160), 
            nrow=3, ncol=3, byrow=T)
rownames(x) <- paste0("Subject", 1:3)
colnames(x) <- paste0("Measurement", 1:3)
kable(x)
```

## I.2. Graphical model

## I.3. Stan model Code

```{r IQ_stan_model, echo = TRUE}
model <- "
// Repeated Measures of IQ
data { 
  int<lower=1> n;
  int<lower=1> m;
  matrix[n, m] x;
}
parameters {
  vector<lower=0,upper=300>[n] mu;
  real<lower=0,upper=100> sigma;
} 
model {
  // Data Come From Gaussians With Different Means
  // But Common Standard Deviation
  for (i in 1:n)
    for (j in 1:m)  
      x[i,j] ~ normal(mu[i], sigma);
}"
```

## I.3  Code

```{r IQ_presample, echo = TRUE, cache = T}

n <- nrow(x) # number of people
m <- ncol(x) # number of repeated measurements

data <- list(x=x, n=n, m=m) # to be passed on to Stan
myinits <- list(
  list(mu=rep(100, n), sigma=1))

# parameters to be monitored: 
parameters <- c("mu", "sigma")
```

## I.3  Code
```{r IQ_sampling, echo = TRUE, cache = T, results = "hide"}

# The following command calls Stan with specific options.
# For a detailed description type "?rstan".
samples <- stan(model_code=model,   
                data=data, 
                init=myinits,  # If not specified, gives random inits
                pars=parameters,
                iter=2000, 
                chains=1, 
                thin=1,
                # warmup = 100,  # Stands for burn-in; Default = iter/2
                # seed = 123  # Setting seed; Default is random seed
                )
# Now the values for the monitored parameters are in the "samples" object, 
# ready for inspection.
```

## I.4. Output and discussion
```{r IQ_output1, echo = FALSE}
kable(print(samples))
```
## I.5. Output and discussion
```{r IQ_output2, echo = FALSE, cache = TRUE}
stan_dens(samples)
```
## I.5. Under a community of priors?

# Case Study II: Hierachical signal detection

# Case Study III: Psychophysical

## Extension to containment

# Conclusion and references

## Take home points
- Bayesian modeling is natural and flexible
- Tools exist to aeou
- collaboration opportunities

## Software used

## References 
